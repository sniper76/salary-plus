
insert into stock_groups (name, description, status, created_at, updated_at, deleted_at)
values ('거래정지종목', '거래정지종목', 'ACTIVE', now(), now(), null);

insert into stock_groups (name, description, status, created_at, updated_at, deleted_at)
values ('일반종목', '일반종목', 'ACTIVE', now(), now(), null);

insert into stock_groups (name, description, status, created_at, updated_at, deleted_at)
values ('자사주소각대상', '자사주소각대상', 'ACTIVE', now(), now(), null);

insert into stock_groups (name, description, status, created_at, updated_at, deleted_at)
values ('자사주소각대상종목2', '자사주소각대상종목2', 'ACTIVE', now(), now(), null);

insert into stock_groups (name, description, status, created_at, updated_at, deleted_at)
values ('거래정지종목(제도개선캠페인)', '거래정지종목(제도개선캠페인)', 'ACTIVE', now(), now(), null);

select *
from stock_groups;

-- 69 건
insert into stock_group_mappings (stock_code, stock_group_id, created_at, updated_at)
select code,
       (select id from stock_groups where name = '거래정지종목'),
       now(),
       now()
from stocks
where code in
      ('136510', '015540', '001340', '093230', '078590', '268600', '318020', '150840', '057880', '033340', '121800',
       '096040', '024810', '109070', '065560', '215090', '178780', '047820', '160600', '078130', '138690', '066410',
       '269620', '056090', '257370', '014200', '226440', '006580', '033180', '102280', '044060', '101140', '032860',
       '069110', '263540', '012600', '003560', '062860', '290380', '052670', '091090', '181340', '007610', '053590',
       '099520', '214870', '141020', '089530', '226360', '005030', '117670', '058530', '111870', '038340', '068940',
       '148140', '219750', '299910', '208860', '114120', '019490', '214310', '030790', '008500', '106520', '217480',
       '174880', '058220', '121890');




insert into stock_group_mappings (stock_code, stock_group_id, created_at, updated_at)
select code,
       (select id from stock_groups where name = '일반종목'),
       now(),
       now()
from stocks
where code not in
      ('136510', '015540', '001340', '093230', '078590', '268600', '318020', '150840', '057880', '033340', '121800',
       '096040', '024810', '109070', '065560', '215090', '178780', '047820', '160600', '078130', '138690', '066410',
       '269620', '056090', '257370', '014200', '226440', '006580', '033180', '102280', '044060', '101140', '032860',
       '069110', '263540', '012600', '003560', '062860', '290380', '052670', '091090', '181340', '007610', '053590',
       '099520', '214870', '141020', '089530', '226360', '005030', '117670', '058530', '111870', '038340', '068940',
       '148140', '219750', '299910', '208860', '114120', '019490', '214310', '030790', '008500', '106520', '217480',
       '174880', '058220', '121890');




insert into stock_group_mappings (stock_code, stock_group_id, created_at, updated_at)
select code,
       (select id from stock_groups where name = '자사주소각대상'),
       now(),
       now()
from stocks
where code in
      ('004700', '003120', '001270', '078000', '001720', '033200', '073110', '166480', '009680', '115310', '003570',
       '009240', '004990', '000950', '001070', '012160', '093520', '363280', '001080', '003540', '006580', '015360',
       '000440', '003090', '096240', '001560', '006040', '049960', '085620', '001530', '034730', '062860', '007540',
       '084010', '003240', '051390', '006800', '035510', '027050', '006370', '000320', '069510', '066900', '017390',
       '008110', '145720', '016800', '087600', '009270', '009290', '007330', '006740', '002870', '004910', '003350',
       '000480', '042500', '003960', '120030', '038950', '226320', '024090', '003460', '019680', '001520', '042420',
       '002030', '053610', '000150', '008870', '052460', '016580', '011780', '119860', '004650', '007210', '002380',
       '128820', '009140', '009160', '006980', '003380', '093190', '095500', '019010', '069080', '012800', '045970',
       '065680', '255220', '134790', '066670', '000810', '017940', '004450', '004690', '100030', '003010', '003830',
       '033780', '005830', '009970', '006260', '001940', '007310', '109080', '030960', '003610', '004310', '029530',
       '017370', '007340', '047560', '010040', '004270', '088350', '053260', '083930', '000390', '053800', '028260',
       '028080', '000070', '017900', '003650', '035200', '001540', '003690', '134060', '054800', '192400', '000120',
       '002230', '040910', '149980', '003100', '001510', '002210', '001450', '026890', '100840', '014160', '203450',
       '058860', '030000', '001740', '054920', '043650', '010400', '011040', '023150', '078070', '024800', '177830',
       '003480', '101240', '044340', '039570', '217820', '036530', '013520', '095610', '149950', '036890', '089790',
       '063570', '058850', '089970', '126700', '052400', '012750', '023460', '020000', '065510', '023410', '054620',
       '004890', '005440', '014470', '010960', '267250', '002450', '005820', '016590', '194480', '005490', '094840',
       '011790', '005180', '029460', '032830', '007370', '234340', '053160', '034830', '049950', '010660');



insert into stock_group_mappings (stock_code, stock_group_id, created_at, updated_at)
select code,
       (select id from stock_groups where name = '자사주소각대상종목2'),
       now(),
       now()
from stocks
where code in
      ('036810', '039010', '084670', '002460', '000490', '041650', '104460', '046140', '064960', '192080', '025900',
       '136540', '065530', '004830', '033270', '072130', '006060', '089470', '015230', '037440', '187270', '123420',
       '025530', '015020', '011760', '078020', '000050', '086900', '003680', '950190', '101530', '096770', '007590',
       '069640', '024950', '217500', '104200', '099440', '155650', '006880', '002220', '377450', '005990', '018310',
       '000180', '080720', '110790', '039420', '035420', '080520', '104700', '214370', '200670', '091340', '002100',
       '003160', '038680', '267980', '014280', '066620', '066790', '052330', '046390', '083310', '012630', '100120',
       '037350', '007460', '091700', '000100', '080160', '090460', '171090', '067830', '043260', '000140', '005810',
       '029780', '101670', '012320', '078340', '075130', '067170', '122450', '066970', '267270', '038010', '088130',
       '073190', '039340', '007860', '214330', '419530', '002790', '037400', '012510', '317830', '036570', '026040',
       '053620', '038290', '054040', '073640', '014910', '041190', '290740', '052670', '005870', '001040', '016920',
       '102120', '001120', '036800', '053690', '039840', '025550', '033920', '083550', '109860', '036460', '084850',
       '019170', '053350', '051360', '092230', '134380', '083500', '030520', '015860', '021320', '131090', '068930',
       '225220', '035900', '000680', '086960', '054540', '024880', '065130', '000670', '004360', '069960', '060980',
       '263860', '141000', '034310', '950130', '206640', '160980', '065370', '095660', '066130', '048260', '006200',
       '280360', '040160', '145990', '010240', '013570', '039440', '216050', '035610', '051900', '069260', '131030',
       '083660', '079950', '005610', '094940', '084730', '018290', '024940', '037760', '049070', '034230', '000700',
       '037460', '067080', '045520', '122900', '039830', '143240', '035080', '034590', '007690', '140070', '059090',
       '100220', '119610', '010690', '002170', '133750', '059120', '078890', '003200', '000970', '094850', '045660',
       '211270', '194700', '003920', '025880', '007120', '038620', '013030', '000520', '000660', '205470', '253590',
       '005670', '144960', '004800', '031980', '031310', '005720', '032960', '035760', '033830', '050760', '065570',
       '008770', '007980', '091440', '050860', '008420', '097780', '071050', '114810', '039490', '005380', '042520',
       '067920', '131180', '015710', '063760', '221980', '033240', '063170', '277070', '035250', '007570', '332570',
       '108230', '194370', '001200', '060370', '299910', '129260', '004490', '228850', '065690', '000220', '239610',
       '138040', '200780', '111110', '067160', '096630', '012030', '053270', '005160', '020710', '017890', '181710',
       '000990');


-- 82건
insert into stock_group_mappings (stock_code, stock_group_id, created_at, updated_at)
select code,
       (select id from stock_groups where name = '거래정지종목(제도개선캠페인)'),
       now(),
       now()
from stocks
where code in
      ('318020', '299910', '299670', '294090', '290380', '286000', '269620', '268600', '263540', '257370', '229500',
       '227420', '226440', '226360', '219750', '217480', '215090', '214870', '214310', '208860', '206950', '181340',
       '178780', '174880', '163430', '161570', '160600', '150840', '150440', '148140', '141020', '138690', '136510',
       '121890', '121800', '117670', '115390', '114120', '111870', '110790', '109070', '106520', '102280', '101140',
       '099520', '093510', '091090', '089530', '08537M', '085370', '078130', '077500', '071460', '068940', '066410',
       '065560', '062860', '058530', '058220', '057880', '056090', '053590', '052670', '047820', '044060', '038340',
       '033340', '033180', '032860', '030790', '019490', '015540', '014200', '012600', '008500', '007610', '005110',
       '005030', '003560', '001340', '001080', '000300');


-- 3건 추가
insert into stock_group_mappings (stock_code, stock_group_id, created_at, updated_at)
select code,
       (select id from stock_groups where name = '거래정지종목(제도개선캠페인)'),
       now(),
       now()
from stocks
where code in
      ('093230', '096040', '024810');


select count(distinct sgm.stock_code) as stock_count
from stock_groups sg
         inner join stock_group_mappings sgm on sg.id = sgm.stock_group_id and sg.name = '거래정지종목';


select count(distinct sgm.stock_code) as stock_count
from stock_groups sg
         inner join stock_group_mappings sgm on sg.id = sgm.stock_group_id and sg.name = '일반종목';


select count(distinct sgm.stock_code) as stock_count
from stock_groups sg
         inner join stock_group_mappings sgm on sg.id = sgm.stock_group_id and sg.name = '자사주소각대상';


select count(distinct sgm.stock_code) as stock_count
from stock_groups sg
         inner join stock_group_mappings sgm on sg.id = sgm.stock_group_id and sg.name = '자사주소각대상종목2';


select count(distinct sgm.stock_code) as stock_count
from stock_groups sg
         inner join stock_group_mappings sgm on sg.id = sgm.stock_group_id and sg.name = '거래정지종목(제도개선캠페인)';


select p.id as postId, b.*, p.*
from posts p
         inner join boards b on p.board_id = b.id and b.group = 'ANALYSIS'
         inner join stock_group_mappings sgm on b.stock_code = sgm.stock_code
         inner join stock_groups sg on sgm.stock_group_id = sg.id and sg.name = '일반종목'
where p.source_post_id is not null
;

select p.*
from posts p
where p.board_id = 2843;


select sgm.stock_code
from stock_groups sg
         inner join stock_group_mappings sgm on sg.id = sgm.stock_group_id and sg.name = '일반종목'
         left outer join boards b on sgm.stock_code = b.stock_code
where b.id is null;
